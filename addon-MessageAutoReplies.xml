<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="MessageAutoReplies" title="MessageAutoReplies" version_string="1.1" version_id="1" url="https://github.com/lol768/MessageAutoReplies/" install_callback_class="MessageAutoReplies\Installer" install_callback_method="install" uninstall_callback_class="MessageAutoReplies\Installer" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates/>
  <admin_template_modifications/>
  <code_events/>
  <code_event_listeners>
    <listener event_id="init_dependencies" execute_order="10" callback_class="\MessageAutoReplies\Listener\Dependencies\Initialize" callback_method="callback" active="1" hint="" description="Initialize dependencies"/>
    <listener event_id="load_class" execute_order="10" callback_class="MessageAutoReplies\Listener\Extend\AccountController" callback_method="callback" active="1" hint="XenForo_ControllerPublic_Account" description="Set auto-responder"/>
    <listener event_id="load_class" execute_order="10" callback_class="MessageAutoReplies\Listener\Extend\AccountViewPublic" callback_method="callback" active="1" hint="XenForo_ViewPublic_Account_PersonalDetails" description="Inject BBCode editor"/>
    <listener event_id="load_class" execute_order="10" callback_class="\MessageAutoReplies\Listener\Extend\ConversationController" callback_method="callback" active="1" hint="XenForo_ControllerPublic_Conversation" description="Override the message sending action for PMs"/>
  </code_event_listeners>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups/>
  <permissions>
    <permission_groups/>
    <permissions/>
    <interface_groups/>
  </permissions>
  <phrases>
    <phrase title="auto_responder" version_id="0" version_string="1.0"><![CDATA[Auto-Responder Message]]></phrase>
    <phrase title="auto_responder_explanation" version_id="0" version_string="1.0"><![CDATA[You can set this field if you'd like an automatic message sent in response to all incoming private messages. This might be useful if you're going on holiday or want to direct users to a specific place to get support.
<br /><br />
A blank message will disable this functionality.]]></phrase>
  </phrases>
  <route_prefixes>
    <route_type type="public">
      <prefix original_prefix="autoresponses" class="MessageAutoReplies\Routing\PublicRoutes" build_link="none"/>
    </route_type>
  </route_prefixes>
  <style_properties/>
  <templates>
    <template title="mar_formatters" version_id="0" version_string="1.0"><![CDATA[<xen:require css="mar_formatters.css" />
<xen:title>Variables</xen:title>
<div class="section">
	<div class="innerContent">
		<p>You can insert a number of variables which the system will automatically replace for you. You can stop the system replacing a particular variable by prepending it with a backslash.</p>
		<table class="dataTable">
			<tbody>
				<tr class="dataRow">
					<th>Variable</th>
					<th>Description</th>
				</tr>
				<tr class="dataRow">
					<td>{username}</td>
					<td>Inserts the sender's username</td>
				</tr>
				<tr class="dataRow">
					<td>{user_id}</td>
					<td>Inserts the sender's user ID</td>
				</tr>
			</tbody>
		</table>
</div>
</div>]]></template>
    <template title="mar_formatters.css" version_id="0" version_string="1.0"><![CDATA[div.section {
    background-color: {xen:property contentBackground} !important;
}

div.innerContent {
    padding: 0.5em !important;
}]]></template>
  </templates>
  <public_template_modifications>
    <modification template="account_personal_details" modification_key="mar_account_personal_details" description="MessageAutoReplies" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:hook name="account_personal_details_about">]]></find>
      <replace><![CDATA[<fieldset>
		<dl class="ctrlUnit">
<dt><label for="ctrl_auto_responder">{xen:phrase auto_responder}:</label><dfn>{xen:phrase you_may_use_bb_code}<br /> <br />{xen:phrase auto_responder_explanation} <br /><a href="{xen:link autoresponses/formatters}" class="OverlayTrigger">Available variables</a></dfn></dt>
			<dd>{xen:raw $autoResponderEditor}</dd>
		</dl>
</fieldset>
$0]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
